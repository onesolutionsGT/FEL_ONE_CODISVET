CREATE PROCEDURE FELONE_LLENAGRID

LANGUAGE SQLSCRIPT

AS

BEGIN

--QUERY-LLENAGRID-------------------------------------------------------------------------------------------------------------------------------------------------------------------	

	SELECT

--CAMPO-SERIES----------------------------------------------------------------------------------------------------------------------------------------------------------------------	
	
		a."Series" 																	AS "Series",

--CAMPO-SERIESNAME------------------------------------------------------------------------------------------------------------------------------------------------------------------	

		a."SeriesName" 																AS "SeriesName",

--CAMPO-TIPO-SERIE------------------------------------------------------------------------------------------------------------------------------------------------------------------	

		CASE "ObjectCode" WHEN 13 THEN 
			CASE "DocSubType" WHEN 'DN' THEN 
				'Nota de Debito' 
			ELSE 
				'Factura' 
			END 
		ELSE 
			CASE "ObjectCode" WHEN 14 THEN 
				'Nota de Credito'
			ELSE 
				'Factura Proveedor' 
			END 
		END 																		AS "Tipo Serie",

--CAMPO-ES-DOCUMENTO-ELECTRONICO----------------------------------------------------------------------------------------------------------------------------------------------------	

		CASE IFNULL(b."U_SERIE", '100') WHEN '100' THEN 
			'0' 
		ELSE 
			'Y' 
		END 																		AS "Es documento electr√≥nico",

--CAMPO-LLENAGRID-------------------------------------------------------------------------------------------------------------------------------------------------------------------	

		b."U_TIPO_DOC" 																AS "Tipo Documento",

--CAMPO-ES-BATCH--------------------------------------------------------------------------------------------------------------------------------------------------------------------	

		CASE IFNULL(b."U_ES_BATCH", '0') WHEN '0' THEN 
			'0' 
		ELSE 
			'Y' 
		END 																		AS "Es batch",

--CAMPO-DISPOSITIVO-----------------------------------------------------------------------------------------------------------------------------------------------------------------	

		b."U_DISPOSITIVO" 															AS "Dispositivo",

--CAMPO-DIRECCION-------------------------------------------------------------------------------------------------------------------------------------------------------------------	

		b."U_DIR" 																	AS "Direccion",

--CAMPO-MUNICIPIO-------------------------------------------------------------------------------------------------------------------------------------------------------------------	

		b."U_MUNI" 																	AS "Municipio",

--CAMPO-DEPARTAMENTO----------------------------------------------------------------------------------------------------------------------------------------------------------------	

		b."U_DEPTO" 																AS "Departamento",

--CAMPO-PAIS------------------------------------------------------------------------------------------------------------------------------------------------------------------------	

		b."U_PAIS" 																	AS "Pais",

--CAMPO-CODIGO-POSTAL---------------------------------------------------------------------------------------------------------------------------------------------------------------	

		b."U_CODP" 																	AS "Codigo Postal",

--CAMPO-NOMBRE-COMERCIAL------------------------------------------------------------------------------------------------------------------------------------------------------------	

		b."U_NOMBRECOMERCIAL" 														AS "Nombre Comercial"
		
--FROM------------------------------------------------------------------------------------------------------------------------------------------------------------------------------	
		
	FROM NNM1 a 
		LEFT OUTER JOIN "@FEL_RESOLUCION" b
		ON  a."Series" = b."U_SERIE"
	WHERE a."ObjectCode" in ('13','14','18')
	ORDER BY a."ObjectCode",a."DocSubType" ; 			
                      
------------------------------------------------------------------------FELONE------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------STANDAR-----------------------------------------------------------------------------------------------------
------------------------------------------------------------------------VERSION-----------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------1.0.0------------------------------------------------------------------------------------------------------

END;